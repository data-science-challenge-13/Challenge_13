---
title: "Islands Pregnancy"
author: "Michaela Fox, Suwanee Li, Lucien Lin"
date: 2025-04-28
output:
  github_document:
    toc: true
---

*Topic:* The topic we chose is the effect of generational differences on age at first pregnancy. The question we wanted to answer was "How does an individual's generation influence the age at which they first become pregnant in the Islands?" We hypothesized that older people would have gotten pregnant at a younger age than younger generations.  

# Setup

<!-- ----------------------------------------------------------------------- -->

```{r}
library(readr)
library(dplyr)
library(stringr)
library(ggplot2)
library(tidyverse)
library(rsample)
```

# Background

<!-- ----------------------------------------------------------------------- -->

The islands are a virtual simulation made by the University of Queensland.  The simulation allows users to interact with people on the islands, conduct tests on them (as long as you have consent), and collect data.

# Data Collection Methods

<!-- ----------------------------------------------------------------------- -->

To collect our data, we designed a custom web scraper using Python libraries such as BeautifulSoup and Selenium. This scraper was used to extract information from Arcadia, a village within the Islands Simulation. Data collection took place on April 27, 2025, and focused on all currently pregnant individuals living in Arcadia. For each person, the scraper reliably gathered their name, current address, current age, the year of their first pregnancy, and their age at first pregnancy. Individuals were then grouped into generational categories based on age: 12–26 as Gen Z, 27–42 as Millennials, 43–58 as Gen X, and 59–77 as Baby Boomers. Individuals older than 77 were categorized as the Silent Generation and were determined to be unimportant to final results due to their small sample size. No individuals under the age of 12 were present in the dataset.

```{r}
# Load data
pregnancy_df <- read_csv("C:/Users/mfox/OneDrive - Olin College of Engineering/Data Science/datasciencefinal/Challenge_13/arcadia_pregnancies.csv")
```

```{r}
# View Data
pregnancy_df
```

```{r}
max(pregnancy_df$`Current Age`, na.rm = TRUE)
```

```{r}
glimpse(pregnancy_df)
summary(pregnancy_df)
```

```{r}
# Get rid of anything that isn't the address
 pregnancy_df <- pregnancy_df %>%
   mutate(
     `Current Address` = str_extract(`Current Address`, "Arcadia\\s*\\d+")
   )
 
 pregnancy_df
```

```{r}
# Check if Pregnancy details column is all the same information and if it is delete it
pregnancy_df %>%
  distinct(`Pregnancy Details`)

pregnancy_df <- pregnancy_df %>%
  filter(Name != "pregnancy details")
```

```{r}
pregnancy_df <- pregnancy_df %>%
  mutate(
    Generation = case_when(
      `Current Age` >= 78 ~ "Silent Generation",
      `Current Age` >= 59 ~ "Baby Boomer",
      `Current Age` >= 43 ~ "Gen X",
      `Current Age` >= 27 ~ "Millennial",
      `Current Age` >= 12 ~ "Gen Z",
      TRUE ~ "Other"
    )
  )
```

```{r}
pregnancy_df %>%
  ggplot(aes(x = `Age at First Pregnancy`, y = `Current Age`, color = Generation)) +
  geom_point(alpha = 0.7, size = 1)
```

```{r}
# Count total number of people by generation in generational order
pregnancy_df %>%
  mutate(Generation = factor(Generation, levels = c("Silent Generation", "Baby Boomer", "Gen X", "Millennial", "Gen Z"))) %>%
  count(Generation) %>%
  ggplot(aes(x = Generation, y = n, fill = Generation)) +
  geom_col() +
  geom_text(aes(label = n), vjust = -0.5) +  # Add count labels
  labs(
    title = "Total Number of People by Generation",
    x = "Generation",
    y = "Count"
  ) +
  theme_minimal() +
  theme(legend.position = "none")

```

```{r}
# Get rid of silent generation because they make up less than 1% of the population
pregnancy_df <- pregnancy_df %>%
  filter(Generation != "Silent Generation")
```

```{r}
# Summarize average age at first pregnancy by generation
pregnancy_df %>%
  mutate(Generation = factor(Generation, levels = c("Silent Generation", "Baby Boomer", "Gen X", "Millennial", "Gen Z"))) %>%
  group_by(Generation) %>%
  summarise(
    median_Age_First_Pregnancy = median(`Age at First Pregnancy`, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  ggplot(aes(x = Generation, y = median_Age_First_Pregnancy, fill = Generation)) +
  geom_col() +
  labs(
    title = "Median Age at First Pregnancy by Generation",
    x = "Generation",
    y = "Median Age at First Pregnancy"
  )

```

```{r}
pregnancy_df %>%
  count(Generation) %>%
  ggplot(aes(x = Generation, y = n, fill = Generation)) +
  geom_col() +
  geom_text(aes(label = n), vjust = -0.5) +  # Add count labels
  labs(
    title = "Total Number of People by Generation",
    x = "Generation",
    y = "Count"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

```{r}
pregnancy_df %>%
  mutate(
    Generation = case_when(
      `Current Age` >= 78 ~ "Silent Generation",
      `Current Age` >= 59 ~ "Baby Boomer",
      `Current Age` >= 43 ~ "Gen X",
      `Current Age` >= 27 ~ "Millennial",
      `Current Age` >= 12 ~ "Gen Z",
      TRUE ~ "Other"
    )
  ) %>%
  ggplot(aes(x = Generation, y = `Age at First Pregnancy`, fill = Generation)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Age at First Pregnancy by Generation",
    x = "Generation",
    y = "Age at First Pregnancy"
  )
```
